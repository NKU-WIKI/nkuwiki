# nkuwiki å¼€æºÂ·å…±æ²»Â·æ™®æƒ çš„å—å¼€ç™¾ç§‘

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)[![Version](https://img.shields.io/badge/version-0.3.0-blue.svg)](https://github.com/your-org/nkuwiki/releases)[![DeepWiki](https://img.shields.io/badge/DeepWiki-documentation-blue)](https://deepwiki.com/NKU-WIKI/nkuwiki)

<img src="./docs/assets/logo-lc-green.png" width="400" alt="nkuwiki logo" />

## demo

![demo](./docs/assets/wxapp.gif)

## ğŸš€ ç«‹å³ä½“éªŒ

- ğŸ”— [Coze](https://www.coze.cn/store/agent/7473464038963036186?bot_id=true&bid=6ffcvvj3k6g0j)
- ğŸ”— [Hiagent](https://coze.nankai.edu.cn/product/llm/chat/cuh2gospkp8br093l2eg)
- ğŸ¤– ä¼å¾®æœºå™¨äººå‚è€ƒ[ä¸‰æ­¥å°†nkuwiki botæ·»åŠ åˆ°ä½ çš„ç¾¤](https://nankai.feishu.cn/wiki/UT4EwiPxmisBdOk3d1ycnGR2nve?from=from_copylink)
- ğŸ” å¾®ä¿¡æœåŠ¡å·ï¼šnkuwikiçŸ¥è¯†ç¤¾åŒºï¼ˆæ— é™åˆ¶ï¼Œç”¨æˆ·ä½“éªŒæ›´å¥½ï¼‰
- ğŸ—ï¸ å¾®ä¿¡è®¢é˜…å· nkuwikiï¼ˆæœ‰æ¶ˆæå›å¤é™åˆ¶ï¼‰
- ğŸ”¥ å¾®ä¿¡å°ç¨‹åºï¼šnkuå…ƒæ™ºwiki
  
![å¾®ä¿¡å°ç¨‹åºç ](https://raw.githubusercontent.com/aokimi0/image-hosting-platform/main/img/2ed4dd7258abda2204b768c7e1017cf.jpg)

## ğŸ¯ æ„¿æ™¯ä¸ç›®æ ‡

æˆ‘ä»¬è‡´åŠ›äºæ„å»º**å—å¼€çŸ¥è¯†å…±åŒä½“**ï¼Œè·µè¡Œ **å¼€æºÂ·å…±æ²»Â·æ™®æƒ ** ä¸‰ä½ä¸€ä½“ä»·å€¼ä½“ç³»
ï¼ˆğŸ”“ æŠ€æœ¯å¼€æºé€æ˜ + ğŸ¤ ç¤¾åŒºååŒå…±æ²» + ğŸ†“ æœåŠ¡æ°¸ä¹…æ™®æƒ ï¼‰ï¼Œå®ç°ï¼š

- ğŸš€ **æ¶ˆé™¤å—å¼€å­¦å­ä¿¡æ¯å·®è·**
- ğŸ’¡ **å¼€æ”¾çŸ¥è¯†èµ„æºå…è´¹è·å–**
- ğŸŒ± **æ„å»ºå¯æŒç»­çš„äº’åŠ©ç¤¾åŒº**

**é¡¹ç›®äº®ç‚¹**ï¼š

- ğŸ¤– **å¼€æºçŸ¥è¯†ä¸­æ¢**
  - ğŸ§  åŒæ“é©±åŠ¨ï¼š**RAG**æ¡†æ¶ + **SOTA**æ¨¡å‹æ¨ç†
  - ğŸ”„ **åŠ¨æ€çŸ¥è¯†å›¾è°±**
    - ğŸ”“ æ¥å…¥**å—å¼€å…¨æ¸ é“æ•°æ®æº**ï¼ˆç½‘ç«™/å¾®ä¿¡å…¬ä¼—å·/æ ¡å›­é›†å¸‚/å°çº¢ä¹¦/å¾®åš/æŠ–éŸ³/Bç«™/çŸ¥ä¹etc.ï¼Œè¯¦è§[æ•°æ®æºé‡ç‚¹å®ä½“æ¸…å•](https://nankai.feishu.cn/wiki/OEuGw04XXiqJnekbawcc9XsQnUf)ï¼‰
    - ğŸ¤ **ç¤¾åŒºå…±æ²»**ï¼šå¿—æ„¿è€…å›¢é˜Ÿä¸ç”¨æˆ·ååŒç»´æŠ¤
    - ğŸ›¡ï¸ **å¼€æºè¯„ä¼°æ¡†æ¶**ï¼ˆè´¡çŒ®è€…é€æ˜å®¡è®¡ï¼‰
  - ğŸ” å¤šæ¨¡æ€å’Œä¸°å¯Œæ’ä»¶æ”¯æŒ
    - æ”¯æŒæ–‡æœ¬/è¯­éŸ³/å›¾åƒ/è§†é¢‘å…¨æ„Ÿå®˜çŸ¥è¯†è·å–
    - ä¸°å¯Œæ’ä»¶æ”¯æŒï¼šæœç´¢å¼•æ“ã€åˆ›æ„ç”Ÿå›¾ã€æ•°æ®åˆ†æetc.

- ğŸ‘¥ **æ™®æƒ å…±æ²»æœºåˆ¶**
  - ä¸‰ç»´ååŒæ¶æ„ï¼š
    - ğŸ’» **æŠ€æœ¯å±‚**ï¼šå¼€æºç¤¾åŒºç»´æŠ¤æ ¸å¿ƒæ ˆ
    - âš–ï¸ **æ²»ç†å±‚**ï¼šDAOå¼å†…å®¹å®¡æ ¸å§”å‘˜ä¼š
    - ğŸ‘¤ **åº”ç”¨å±‚**ï¼šè´¡çŒ®å³æ²»ç†ï¼ˆ1Token=1æŠ•ç¥¨æƒï¼‰

## âš¡ å¿«é€Ÿå¼€å§‹

1. **å…‹éš†é¡¹ç›®**
```bash
git clone https://github.com/NKU-WIKI/nkuwiki.git
cd nkuwiki
git submodule update --init --recursive
```

2. **ç¯å¢ƒå‡†å¤‡ (æ¨è)**
    - ç¡®ä¿ä½ å·²å®‰è£… Python 3.10+ã€‚
    - ä¸ºäº†é¿å…ä¾èµ–å†²çªï¼Œå¼ºçƒˆå»ºè®®åœ¨ Python è™šæ‹Ÿç¯å¢ƒä¸­å®‰è£…é¡¹ç›®ã€‚

    <details>
    <summary>ç‚¹å‡»æŸ¥çœ‹å¦‚ä½•åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</summary>

    **æ–¹æ³•ä¸€: ä½¿ç”¨ venv (Pythonè‡ªå¸¦)**
    ```bash
    # åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºåä¸º .venv çš„è™šæ‹Ÿç¯å¢ƒ
    python3 -m venv .venv

    # æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
    # Linux/MacOS
    source .venv/bin/activate 
    # Windows
    .venv\\Scripts\\activate
    ```

    **æ–¹æ³•äºŒ: ä½¿ç”¨ conda**
    ```bash
    # åˆ›å»ºåä¸º nkuwiki çš„ç¯å¢ƒ
    conda create -n nkuwiki python=3.10 -y

    # æ¿€æ´»ç¯å¢ƒ
    conda activate nkuwiki
    ```
    </details>

3. **å®‰è£…ä¾èµ–**
```bash
pip install -r requirements.txt

# å®‰è£… Playwright çš„æµè§ˆå™¨ä¾èµ–
playwright install chromium
```

4. **é…ç½®é¡¹ç›®**
    - åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `config.json` æ–‡ä»¶ï¼Œå¹¶å¡«å…¥å¿…è¦çš„é…ç½®ï¼Œä¾‹å¦‚ä½ çš„å¤§æ¨¡å‹API Keyã€‚
    - æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è€ƒ `docs/configuration_guide.md`ã€‚

5. **å¯åŠ¨é—®ç­”æœåŠ¡**

    æœ¬é¡¹ç›®æ”¯æŒå¤šç§æ¸ é“ä¸ç”¨æˆ·äº¤äº’ï¼Œæ ¸å¿ƒå¯åŠ¨å‘½ä»¤æ˜¯ `python app.py`ã€‚

    **a. ç»ˆç«¯æ¨¡å¼ (é»˜è®¤)**

    ç›´æ¥åœ¨å‘½ä»¤è¡Œä¸­ä¸æ™ºèƒ½ä½“è¿›è¡Œå¯¹è¯ï¼Œé€‚åˆå¼€å‘å’Œå¿«é€Ÿæµ‹è¯•ã€‚

    ```bash
    python app.py
    ```
    ![ç»ˆç«¯æ¨¡å¼æ•ˆæœ](./docs/assets/terminal-qa.png)

    **b. APIæœåŠ¡æ¨¡å¼**

    å°†é—®ç­”èƒ½åŠ›å°è£…ä¸ºRESTful APIï¼Œä¾›å‰ç«¯æˆ–å…¶ä»–æœåŠ¡è°ƒç”¨ã€‚

    ```bash
    # å¯åŠ¨APIæœåŠ¡ï¼Œç›‘å¬åœ¨8000ç«¯å£
    python app.py --api --port 8000

    # æ£€æŸ¥æœåŠ¡å¥åº·çŠ¶æ€
    curl -X GET "http://localhost:8000/api/health"
    ```

6.  **è¿è¡ŒETLä¸çˆ¬è™«**

    ETLï¼ˆæ•°æ®æå–ã€è½¬æ¢ã€åŠ è½½ï¼‰æ˜¯ä¿è¯çŸ¥è¯†åº“æŒç»­æ›´æ–°çš„æ ¸å¿ƒã€‚

    ```bash
    # è¿è¡ŒETLå…¨æµç¨‹ï¼ˆæ‰«æã€ç´¢å¼•ã€æ´å¯Ÿï¼‰ï¼Œå¤„ç†è¿‡å»24å°æ—¶çš„æ•°æ®
    python etl/daily_pipeline.py

    # ä»…è¿è¡Œå¾®ä¿¡å…¬ä¼—å·çˆ¬è™«
    python -m etl.crawler.wechat

    # ä»…è¿è¡Œæ ¡å›­é›†å¸‚çˆ¬è™«
    python -m etl.crawler.market
    ```
    - æ›´å¤šå…³äºETLå’Œçˆ¬è™«çš„ä½¿ç”¨è¯´æ˜ï¼Œè¯·å‚è€ƒ [ETLæµç¨‹æŒ‡å—](./docs/etl_pipeline_guide.md) å’Œ [çˆ¬è™«å¼€å‘æŒ‡å—](./docs/crawler_guide.md)ã€‚

## ğŸ— ç³»ç»Ÿæ¶æ„

![ç³»ç»Ÿæ¶æ„å›¾](./docs/assets/ç³»ç»Ÿæ¶æ„å›¾.png)

é¡¹ç›®é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹æ¨¡å—ï¼š

- **core/**: æ ¸å¿ƒåŠŸèƒ½æ¨¡å—
  - agent/: æ™ºèƒ½ä½“å¯¹è¯å®ç°
  - utils/: é€šç”¨å·¥å…·

- **etl/**: æ•°æ®å¤„ç†æ¨¡å—
  - crawler/: æ•°æ®é‡‡é›† (è¯¦è§ [çˆ¬è™«æ¨¡å—ä½¿ç”¨æŒ‡å—](./docs/crawler_guide.md))
  - transform/: æ•°æ®è½¬æ¢
  - load/: æ•°æ®åŠ è½½
  - embedding/: å‘é‡åµŒå…¥
  - retrieval/: çŸ¥è¯†æ£€ç´¢

- **api/**: APIæœåŠ¡æ¨¡å—
  - models/: æ•°æ®æ¨¡å‹
  - routes/: è·¯ç”±å¤„ç†
  - common/: é€šç”¨å·¥å…·

- **services/**: å¤šæ¸ é“æœåŠ¡
  - app/: å¾®ä¿¡å°ç¨‹åº
  - wechatmp/: å¾®ä¿¡å…¬ä¼—å·
  - wework/: å¾®ä¿¡æœºå™¨äºº
  - website/: ç½‘ç«™
  - terminal/: ç»ˆç«¯æœåŠ¡

## ğŸ’» æŠ€æœ¯å®ç°

### æŠ€æœ¯é€‰å‹

| æ¨¡å— | å­æ¨¡å— | æŠ€æœ¯æ ˆ | ç‰ˆæœ¬ | é€‰å‹ä¾æ® |
| --- | --- | --- | --- | --- |
| **çˆ¬è™«å¼•æ“** | æ··åˆé‡‡é›†æ¶æ„ | Playwright + Selenium | 1.42.0 / 4.18.0 | åŒå¼•æ“è¦†ç›–ç°ä»£SPAä¸ä¼ ç»Ÿç½‘é¡µåœºæ™¯ï¼ŒPlaywrightå¤„ç†å¤æ‚DOMæ€§èƒ½æå‡40% |
| **æ•°æ®æ¸…æ´—** | æ•°æ®æ¸…æ´— | Pandera + DuckDB | 0.11.0 / 0.9.2 | å£°æ˜å¼æ•°æ®éªŒè¯æ¡†æ¶ + åˆ—å¼å­˜å‚¨å®æ—¶å¤„ç†èƒ½åŠ› |
| **å­˜å‚¨å±‚** | å¯¹è±¡å­˜å‚¨ | SeaweedFS | 3.64 | å¯¹è±¡å­˜å‚¨ä¸æ–‡ä»¶ç³»ç»Ÿç»Ÿä¸€æ¥å£ï¼Œè‡ªåŠ¨çº åˆ ç æœºåˆ¶ |
| **Agentæ¨¡å—** | APIäº¤äº’å±‚ | FastAPI + HTTPX | 0.110.0 | å¼‚æ­¥HTTPå®¢æˆ·ç«¯æ”¯æŒSSE/WebSocketé•¿è¿æ¥ |
| **å¾®ä¿¡æœåŠ¡** | æ¶ˆæ¯è·¯ç”± | FastAPI WebSocket | 0.110.0 | æ”¯æŒä¸‡äººçº§å¹¶å‘æ¶ˆæ¯æ¨é€ï¼Œæ¶ˆæ¯å‹ç¼©ç‡60%+ |
| **åŸºç¡€è®¾æ–½** | å®¹å™¨ç¼–æ’ | Docker Compose | 2.24.5 | æ”¯æŒæœåŠ¡ä¾èµ–ç®¡ç†ï¼Œå¼€å‘-ç”Ÿäº§ç¯å¢ƒä¸€è‡´æ€§ä¿éšœ |

### æ ¸å¿ƒæ¨¡å—å®ç°

#### çˆ¬è™«æ··åˆæ¶æ„å®ç°æ–¹æ¡ˆ

![çˆ¬è™«æ··åˆæ¶æ„æ–¹æ¡ˆ](./docs/assets/çˆ¬è™«æ··åˆæ¶æ„æ–¹æ¡ˆ.png)

è¯´æ˜ï¼š

1. **å¤æ‚ç™»å½•åœºæ™¯**ï¼šä½¿ç”¨Seleniumå¤„ç†å—å¼€æ•™åŠ¡ç³»ç»Ÿç­‰éœ€è¦æ¨¡æ‹Ÿå®Œæ•´ç™»å½•æµç¨‹çš„ç³»ç»Ÿ
2. **æ··åˆæŠ“åŒ…æ¨¡å¼**ï¼šç»“åˆMitmproxy+Selenium Wireå®ç°å…¬ä¼—å·APIè¯·æ±‚æ•è·
3. **ååçˆ¬ç­–ç•¥**ï¼šé€šè¿‡Browserlessé›†ç¾¤å®ç°IPè½®æ¢å’Œæµè§ˆå™¨æŒ‡çº¹æ··æ·†
4. **æ€§èƒ½å¹³è¡¡**ï¼šPlaywrightå¤„ç†ç°ä»£Webåº”ç”¨ï¼ˆBç«™/å°çº¢ä¹¦ï¼‰ï¼ŒSeleniumä¸“æ³¨å¤æ‚ä¼ ç»Ÿç³»ç»Ÿ

#### çŸ¥è¯†åº“å…¥åº“æµç¨‹

![çŸ¥è¯†åº“å…¥åº“æµç¨‹](./docs/assets/çŸ¥è¯†åº“å…¥åº“æµç¨‹.png)

#### agentäº¤äº’æ¶æ„

![agentäº¤äº’æ¶æ„](./docs/assets/agentäº¤äº’æ¶æ„.png)

## ğŸ“ é¡¹ç›®ç›®å½•ç»“æ„

```
nkuwiki/
â”œâ”€â”€ api/                  # FastAPI åç«¯APIæ¨¡å—
â”‚   â”œâ”€â”€ models/           # Pydantic æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ routes/           # API è·¯ç”±å¤„ç†
â”œâ”€â”€ core/                 # æ ¸å¿ƒå…±äº«æ¨¡å—
â”‚   â”œâ”€â”€ agent/            # RAG ä¸å¤šæ™ºèƒ½ä½“æ ¸å¿ƒé€»è¾‘
â”‚   â””â”€â”€ utils/            # é€šç”¨å·¥å…·ï¼ˆæ—¥å¿—ã€ç¼“å­˜ç­‰ï¼‰
â”œâ”€â”€ data/                 # æ•°æ®æŒä¹…åŒ–ç›®å½• (Gitå¿½ç•¥)
â”‚   â”œâ”€â”€ mysql/            # MySQL æ•°æ®æ–‡ä»¶
â”‚   â”œâ”€â”€ qdrant/           # Qdrant å‘é‡æ•°æ®
â”‚   â”œâ”€â”€ raw/              # çˆ¬è™«æŠ“å–çš„åŸå§‹æ•°æ®
â”‚   â””â”€â”€ models/           # ä¸‹è½½çš„AIæ¨¡å‹
â”œâ”€â”€ docs/                 # é¡¹ç›®æ–‡æ¡£å’Œèµ„äº§
â”‚   â””â”€â”€ assets/           # æ–‡æ¡£ä¸­å¼•ç”¨çš„å›¾ç‰‡
â”œâ”€â”€ etl/                  # æ•°æ®æå–ã€è½¬æ¢ã€åŠ è½½ (ETL) ç®¡é“
â”‚   â”œâ”€â”€ crawler/          # å„ç±»çˆ¬è™«å®ç°
â”‚   â”œâ”€â”€ load/             # æ•°æ®åŠ è½½åˆ°æ•°æ®åº“çš„é€»è¾‘
â”‚   â””â”€â”€ daily_pipeline.py # æ¯æ—¥è¿è¡Œçš„ETLä»»åŠ¡ç¼–æ’å™¨
â”œâ”€â”€ infra/                # åŸºç¡€è®¾æ–½ä¸éƒ¨ç½²é…ç½®
â”‚   â””â”€â”€ monitoring/       # ç›‘æ§ç›¸å…³é…ç½®
â”œâ”€â”€ services/             # å¤šæ¸ é“æœåŠ¡æ¥å£
â”‚   â”œâ”€â”€ wechatmp/         # å¾®ä¿¡å…¬ä¼—å·æœåŠ¡
â”‚   â””â”€â”€ terminal/         # ç»ˆç«¯äº¤äº’æœåŠ¡
â”œâ”€â”€ app.py                # âœ… åº”ç”¨ä¸»å…¥å£ï¼Œç”¨äºå¯åŠ¨æœåŠ¡
â”œâ”€â”€ config.py             # âš™ï¸ å…¨å±€é…ç½®åŠ è½½ä¸ç®¡ç†
â”œâ”€â”€ config.json           # ğŸ”’ é…ç½®æ–‡ä»¶ (ç§å¯†ï¼Œéœ€è‡ªè¡Œåˆ›å»º)
â”œâ”€â”€ Dockerfile            # ğŸ“¦ åº”ç”¨æœåŠ¡çš„ Docker é•œåƒå®šä¹‰
â”œâ”€â”€ docker-compose.yml    # ğŸ³ åº”ç”¨æœåŠ¡ (api) çš„ Docker Compose æ–‡ä»¶
â”œâ”€â”€ docker-compose.infra.yml # ğŸ—ï¸ åŸºç¡€è®¾æ–½ (DB, Redisç­‰) çš„ Docker Compose æ–‡ä»¶
â”œâ”€â”€ nkuwiki_service_manager.sh # ğŸš€ è‡ªåŠ¨åŒ–éƒ¨ç½²ä¸ç®¡ç†è„šæœ¬
â””â”€â”€ requirements.txt      # Python ä¾èµ–åˆ—è¡¨
```

### æ ¸å¿ƒç›®å½•èŒè´£

-   **`api/`**: è´Ÿè´£å¯¹å¤–æä¾›æ ‡å‡†çš„ RESTful APIã€‚å®ƒæ˜¯å‰åç«¯åˆ†ç¦»çš„æ ¸å¿ƒï¼Œå®šä¹‰äº†æ‰€æœ‰çš„æ•°æ®æ¥å£å’Œæ•°æ®æ¨¡å‹ã€‚
-   **`core/`**: åŒ…å«é¡¹ç›®ä¸­æœ€æ ¸å¿ƒçš„ä¸šåŠ¡é€»è¾‘ï¼Œç‰¹åˆ«æ˜¯ `agent` æ¨¡å—ï¼Œå®ƒå®ç°äº†å®Œæ•´çš„ RAG (æ£€ç´¢å¢å¼ºç”Ÿæˆ) æµç¨‹å’Œå¤šæ™ºèƒ½ä½“åä½œã€‚
-   **`etl/`**: é¡¹ç›®çš„æ•°æ®ä¸­æ¢ã€‚æ‰€æœ‰å¤–éƒ¨æ•°æ®çš„æŠ“å–ã€æ¸…æ´—ã€å¤„ç†ã€ç´¢å¼•ã€å…¥åº“éƒ½åœ¨æ­¤æ¨¡å—å®Œæˆï¼Œæ˜¯ä¿è¯çŸ¥è¯†åº“æ–°é²œã€å‡†ç¡®çš„å…³é”®ã€‚
-   **`services/`**: é¢å‘ç»ˆç«¯ç”¨æˆ·çš„æœåŠ¡å±‚ã€‚å®ƒå°† `core` æ¨¡å—çš„æ ¸å¿ƒèƒ½åŠ›å°è£…æˆä¸åŒçš„æœåŠ¡å½¢å¼ï¼Œå¦‚å¾®ä¿¡å…¬ä¼—å·ã€ç»ˆç«¯å‘½ä»¤è¡Œç­‰ã€‚
-   **`infra/`**: å­˜æ”¾æ‰€æœ‰ä¸éƒ¨ç½²ã€è¿ç»´ã€ç›‘æ§ç›¸å…³çš„é…ç½®ï¼Œå¦‚ `docker-compose` æ–‡ä»¶ã€`Dockerfile` å’Œ `Nginx` é…ç½®ã€‚

## ğŸ“… æ¼”è¿›è·¯çº¿

| é˜¶æ®µ | å…³é”®é‡Œç¨‹ç¢‘ | æŠ€æœ¯æ ˆä¸æ¶æ„å†³ç­– | äº¤ä»˜äº§ç‰© |
| --- | --- | --- | --- |
| **MVPå¯åŠ¨æœŸ** | âœ… æ ¸å¿ƒæœåŠ¡ä¸Šçº¿ | ğŸ›  FastAPIï¼ˆAPIç½‘å…³ï¼‰ | ğŸ“¦ å®¹å™¨åŒ–æ ¸å¿ƒæœåŠ¡ |
| (0-3æœˆ) | â–ª å¾®ä¿¡å…¬ä¼—å·æ™ºèƒ½é—®ç­”MVP | ğŸ¤– Cozeï¼ˆæ™ºèƒ½Agentï¼‰ | ğŸ“š éƒ¨ç½²æŒ‡å—+è¿ç»´æ‰‹å†Œ |
| **ç”Ÿæ€æ„å»ºæœŸ** | ğŸš€ æ ¸å¿ƒç³»ç»Ÿæ‰©å±• | ğŸ•¸ Scrapyï¼ˆåˆ†å¸ƒå¼çˆ¬è™«ï¼‰ | ğŸ§© å¯æ’æ‹”çˆ¬è™«æ¡†æ¶ |
| (4-6æœˆ) | â–ª å…¨å¹³å°çˆ¬è™«è¦†ç›– | ğŸ“Š Prometheus+Grafanaï¼ˆç›‘æ§ï¼‰ | ğŸ“ˆ è´¨é‡è¯„ä¼°ç³»ç»Ÿ |
| **ä½“ç³»å‡çº§æœŸ** | ğŸŒŸ ç³»ç»Ÿæ¶æ„æ¼”è¿› | â˜ Spring Cloud Alibabaï¼ˆå¾®æœåŠ¡ï¼‰ | ğŸ”„ ç§¯åˆ†ç³»ç»Ÿå¾®æœåŠ¡é›†ç¾¤ |
| (7-9æœˆ) | â–ª å¾®æœåŠ¡åŒ–æ”¹é€  | ğŸ“¦ ELKï¼ˆæ—¥å¿—åˆ†æï¼‰ | ğŸ‘ï¸ ç³»ç»Ÿå¥åº·çœ‹æ¿ |

## ğŸ”§ å¼€å‘æŒ‡å—

- **APIæ–‡æ¡£**: [API Documentation](./docs/api_docs.md)
- **ETLæµç¨‹**: [ETL Pipeline Guide](./docs/etl_pipeline_guide.md)
- **çˆ¬è™«å¼€å‘**: [Crawler Development Guide](./docs/crawler_guide.md)
- **RAGæ¶æ„**: [RAG Strategy](./docs/rag.md)
- **è¯¦ç»†é…ç½®**: [Configuration Guide](./docs/configuration_guide.md)

æˆ–å‚è€ƒå®Œæ•´çš„[é£ä¹¦å¼€å‘æ–‡æ¡£](https://nankai.feishu.cn/wiki/U3hSweEsUiJDHKkQtVycuNSMnMe)ã€‚

## ğŸ”© éƒ¨ç½²æŒ‡å— (Docker & Systemd)

æœ¬é¡¹ç›®æä¾›äº†ä¸€å¥—åŸºäº Docker å’Œ `systemd` çš„è‡ªåŠ¨åŒ–éƒ¨ç½²æ–¹æ¡ˆï¼Œé€šè¿‡ `nkuwiki_service_manager.sh` è„šæœ¬å¯ä»¥æ–¹ä¾¿åœ°åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šç®¡ç† `main` (ç”Ÿäº§) å’Œ `dev` (å¼€å‘) ä¸¤ä¸ªç¯å¢ƒã€‚

### 1. ç¯å¢ƒè¦æ±‚

åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„æœåŠ¡å™¨ï¼ˆæ¨è Ubuntu 22.04+ï¼‰æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š
- `root` ç”¨æˆ·æƒé™ã€‚
- å·²å®‰è£… [Git](https://git-scm.com/downloads)ã€‚
- å·²å®‰è£… [Docker](https://docs.docker.com/engine/install/ubuntu/) å’Œ [Docker Compose](https://docs.docker.com/compose/install/)ã€‚
- å·²å®‰è£… [Nginx](https://www.digitalocean.com/community/tutorials/how-to-install-nginx-on-ubuntu-22-04)ã€‚

### 2. éƒ¨ç½²æ­¥éª¤

æ‰€æœ‰éƒ¨ç½²æ“ä½œéƒ½é€šè¿‡ `nkuwiki_service_manager.sh` è„šæœ¬å®Œæˆï¼Œè¯¥è„šæœ¬éœ€è¦ä»¥ `root` æƒé™è¿è¡Œã€‚

```bash
sudo ./nkuwiki_service_manager.sh [å‘½ä»¤] [å‚æ•°]
```

#### **ç¬¬ä¸€æ­¥ï¼šå¯åŠ¨åŸºç¡€è®¾æ–½æœåŠ¡ (ä»…éœ€ä¸€æ¬¡)**

åŸºç¡€è®¾æ–½ï¼ˆæ•°æ®åº“ã€ç¼“å­˜ç­‰ï¼‰æ˜¯æ‰€æœ‰åˆ†æ”¯å…±äº«çš„ã€‚é¦–æ¬¡éƒ¨ç½²æ—¶ï¼Œéœ€è¦å…ˆå¯åŠ¨å®ƒä»¬ã€‚

```bash
sudo ./nkuwiki_service_manager.sh start-infra
```
æ­¤å‘½ä»¤ä¼šä½¿ç”¨ `docker-compose.infra.yml` åœ¨åå°å¯åŠ¨ `MySQL`, `Redis`, `Qdrant` å’Œ `Elasticsearch` å®¹å™¨ã€‚

#### **ç¬¬äºŒæ­¥ï¼šéƒ¨ç½²åº”ç”¨åˆ†æ”¯ (main/dev)**

æ‚¨å¯ä»¥ç‹¬ç«‹éƒ¨ç½² `main` æˆ– `dev` åˆ†æ”¯çš„åº”ç”¨ã€‚

- **éƒ¨ç½² `main` åˆ†æ”¯ (ç”Ÿäº§ç¯å¢ƒ)**
  ```bash
  sudo ./nkuwiki_service_manager.sh start main
  ```
  è¯¥å‘½ä»¤ä¼šè‡ªåŠ¨å®Œæˆä»¥ä¸‹å·¥ä½œï¼š
  1. æ„å»º `api` æœåŠ¡çš„ Docker é•œåƒã€‚
  2. å¯åŠ¨ä¸€ä¸ªåä¸º `nkuwiki_main` çš„å®¹å™¨ï¼ŒAPI æœåŠ¡ç›‘å¬åœ¨ **8000** ç«¯å£ã€‚
  3. æ›´æ–° Nginx é…ç½®ï¼Œå°†æµé‡å¯¼å‘è¯¥å®¹å™¨ã€‚
  4. åˆ›å»ºå¹¶å¯ç”¨ `systemd` æœåŠ¡ `nkuwiki@main.service`ï¼Œå®ç°å¼€æœºè‡ªå¯ã€‚

- **éƒ¨ç½² `dev` åˆ†æ”¯ (å¼€å‘ç¯å¢ƒ)**
  ```bash
  sudo ./nkuwiki_service_manager.sh start dev
  ```
  ä¸éƒ¨ç½² `main` åˆ†æ”¯ç±»ä¼¼ï¼Œä½† `api` æœåŠ¡å°†ç›‘å¬åœ¨ **8001** ç«¯å£ï¼Œå®¹å™¨åä¸º `nkuwiki_dev`ï¼Œ`systemd` æœåŠ¡ä¸º `nkuwiki@dev.service`ã€‚

#### **ç¬¬ä¸‰æ­¥ï¼šéªŒè¯éƒ¨ç½²**

éƒ¨ç½²å®Œæˆåï¼Œæ‚¨å¯ä»¥é€šè¿‡ `status` å‘½ä»¤æ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼š

```bash
# æŸ¥çœ‹ main åˆ†æ”¯çŠ¶æ€
sudo ./nkuwiki_service_manager.sh status main

# æŸ¥çœ‹ dev åˆ†æ”¯çŠ¶æ€
sudo ./nkuwiki_service_manager.sh status dev

# æŸ¥çœ‹å…±äº«çš„åŸºç¡€è®¾æ–½çŠ¶æ€
sudo ./nkuwiki_service_manager.sh status-infra
```

### 3. æœåŠ¡ç®¡ç†

ä½¿ç”¨ç®¡ç†è„šæœ¬å¯ä»¥æ–¹ä¾¿åœ°å¯¹æœåŠ¡è¿›è¡Œæ—¥å¸¸ç»´æŠ¤ã€‚

- **åœæ­¢æœåŠ¡**: `sudo ./nkuwiki_service_manager.sh stop [main|dev]`
- **é‡å¯æœåŠ¡**: `sudo ./nkuwiki_service_manager.sh restart [main|dev]`
- **æŸ¥çœ‹æ—¥å¿—**: `sudo ./nkuwiki_service_manager.sh logs [main|dev]`

### 4. Nginx è·¯ç”±æœºåˆ¶ï¼šå¦‚ä½•åˆ‡æ¢ main/dev ç¯å¢ƒ

Nginx ä½œä¸ºåå‘ä»£ç†ï¼Œå¯ä»¥æ ¹æ®å®¢æˆ·ç«¯è¯·æ±‚çš„ HTTP å¤´åŠ¨æ€åœ°å°† API è¯·æ±‚è½¬å‘åˆ° `main` æˆ– `dev` ç¯å¢ƒã€‚

- **åˆ‡æ¢æœºåˆ¶**: é€šè¿‡ `X-Branch` è¯·æ±‚å¤´æ¥åˆ‡æ¢ã€‚
  - `X-Branch: dev`: è¯·æ±‚å°†è¢«è½¬å‘åˆ° `dev` ç¯å¢ƒ (8001ç«¯å£)ã€‚
  - `X-Branch: main` æˆ– **ä¸æä¾›æ­¤è¯·æ±‚å¤´**: è¯·æ±‚å°†è¢«è½¬å‘åˆ° `main` ç¯å¢ƒ (8000ç«¯å£)ã€‚

- **å‰ç«¯åº”ç”¨é¡»çŸ¥**:
  å¦‚æœå‰ç«¯åº”ç”¨éœ€è¦è¿æ¥åˆ° `dev` ç¯å¢ƒè¿›è¡Œæµ‹è¯•ï¼Œå¼€å‘è€…å¿…é¡»åœ¨å‘èµ· API è¯·æ±‚æ—¶ï¼Œæ‰‹åŠ¨æ·»åŠ  `X-Branch: dev` è¿™ä¸ª HTTP Headerã€‚

  ç¤ºä¾‹ (ä½¿ç”¨ `curl`):
  ```bash
  # è¯·æ±‚å°†å‘é€åˆ° main ç¯å¢ƒ
  curl http://your-domain.com/api/some-endpoint

  # è¯·æ±‚å°†å‘é€åˆ° dev ç¯å¢ƒ
  curl -H "X-Branch: dev" http://your-domain.com/api/some-endpoint
  ```

### 5. å¼€æœºè‡ªå¯ (Systemd)

`start` å‘½ä»¤ä¼šè‡ªåŠ¨ä¸ºæ‚¨åˆ›å»º `systemd` æœåŠ¡ï¼Œä½¿åº”ç”¨èƒ½å¤Ÿåœ¨æœåŠ¡å™¨é‡å¯åè‡ªåŠ¨è¿è¡Œã€‚

æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨æ ‡å‡†çš„ `systemctl` å‘½ä»¤æ¥æ‰‹åŠ¨ç®¡ç†è¿™äº›æœåŠ¡ï¼š
```bash
# ç®¡ç† main åˆ†æ”¯æœåŠ¡
sudo systemctl [start|stop|status|restart] nkuwiki@main.service

# ç®¡ç† dev åˆ†æ”¯æœåŠ¡
sudo systemctl [start|stop|status|restart] nkuwiki@dev.service
```

## ğŸ¤ å¦‚ä½•å‚ä¸

â­ **è”ç³»æ–¹å¼**ï¼šæ‚¨å¯ä»¥ç›´æ¥æ·»åŠ å¾®ä¿¡ `ao_kimi` ï¼Œé£ä¹¦è”ç³» @å»–æœ›ï¼Œæˆ–è€…è”ç³»å¼€å‘å›¢é˜Ÿä¸å¿—æ„¿è€…å›¢é˜Ÿä»»æ„æˆå‘˜ã€‚

ğŸŒ± **ä½¿ç”¨å³è´¡çŒ®ï¼Œè´¡çŒ®å³æ²»ç†**ï¼šæ‚¨å¯ä»¥é€šè¿‡ä½¿ç”¨æˆ‘ä»¬çš„æœåŠ¡ï¼Œè”ç³»æˆ‘ä»¬åé¦ˆæ‚¨çš„å®è´µæ„è§ï¼Œå‘æœ‹å‹å®‰åˆ©æˆ‘ä»¬çš„æœåŠ¡ï¼Œä¸Šä¼ æ‚¨è®¤ä¸ºæœ‰ä»·å€¼çš„èµ„æ–™ï¼Œåœ¨æˆ‘ä»¬çš„é¡¹ç›®æissueæˆ–PRï¼Œæˆ–è€…ç›´æ¥åŠ å…¥å¼€å‘å›¢é˜Ÿä¸å¿—æ„¿è€…å›¢é˜Ÿç­‰å¤šç§æ–¹å¼ä¸ºç¤¾åŒºå‘å±•ä½œå‡ºè´¡çŒ®ã€‚æˆ‘ä»¬æ¬¢è¿ä»»ä½•å½¢å¼ï¼Œä¸è®¡å¤§å°çš„è´¡çŒ®ï¼

ç°ä»»å¼€å‘å›¢é˜Ÿï¼š

- [@aokimi0](https://github.com/aokimi0)
- [@client2233](https://github.com/client2233)
- [@Frederick2313072](https://github.com/Frederick2313072)
- [@Because66666](https://github.com/Because66666)
- [@ghost233lism](https://github.com/ghost233lism)
- [@hht421](https://github.com/hht421)


ç°ä»»å¿—æ„¿è€…å›¢é˜Ÿï¼š
- [@aokimi0](https://github.com/aokimi0)
- [@hht421](https://github.com/hht421)
- [@hengdaoye50](https://github.com/hengdaoye50)
- [@Because66666](https://github.com/Because66666)
